<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

        <title>Advanced Git: Workflows for Developers</title>

		<meta name="description" content="Personal, Team and Release workflows for Git">
		<meta name="author" content="Matthew B. Gray">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<!--<link rel="stylesheet" href="css/theme/solarized.css" id="theme">-->
		<link rel="stylesheet" href="css/theme/catalyst.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/solarized_light.css">

		<style type="text/css">
			.align-top-images img {
				vertical-align: top;
			}
			.workflow-images img {
				float: right;
				max-height: 450px;
			}
			.workflow-images ul {
				display: block;
			}
		</style>

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
            <script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="reveal">
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<!-- Cover slide -->
				<section>
					<h1 class="catalyst-logo">Catalyst</h1>
					<h3>Advanced Git</h3>
					<h4>Workflows for Developers</h4>
					<p class="small-text">
					</p>
					<p class="small-text">
						Slides by <a href="http://matthew.geek.nz">Matthew B. Gray</a>
						/ <a href="https://twitter.com/theflimflam">@theflimflam</a> and <a href="http://github.com/ben-denham">Ben Denham</a>
					</p>

					<aside class="notes">
						<ul>
							<li>Breaks every 30 minutes for 3 minutes</li>
							<li>Expecting this course to go for 3~4hrs</li>
							<li>Have the WR ready</li>
							<li>Check projector light/dark themes</li>
						</ul>
					</aside>
				</section>

				<section>
					<h2>Administrivia</h2>
					<ul>
						<li>Bathrooms</li>
						<li>Fire exits</li>
					</ul>
				</section>

				<section>
					<h2>Special thanks to</h2>
					<ul>
						<li>Mike O' – For approving this course</li>
						<li>Alison Aldred – Organise all the things</li>
						<li>Evan Giles – Inspiration and advice</li>
						<li>Robert Higgins – Standardisation and profesionalism</li>
						<li>Matthew Gray - Original author of this course</li>
					</ul>
				</section>

				<!-- Course Overview -->
				<section data-markdown>
					## Course Overview
					--------------------------------------------------------------------------------
					* Part 1: Getting Started
					* Part 2: Personal workflows
					* Part 3: Team workflows
					* Part 4: Releases and Client workflows
				</section>

				<section data-background-image="images/swag.gif">
					<aside class="notes">
						How you should feel with Git after this course.
					</aside>
				</section>

				<!-- Setup your git fu, review some basic stuff -->
				<section>
					<section data-markdown>
						### Part 1: Getting started
						* Part 2: Personal workflows
						* Part 3: Team workflows
						* Part 4: Releases and Client workflows
						--------------------------------------------------------------------------------
						### Objectives
						<!--
						- Install some stuff
						-->
						- Basic config for these machines
						- Good config defaults
						- Quick review of basic git
						<!--
						- Unlocking achievements, making git a bit more fun
						-->
					</section>

<!--
					<section data-markdown>
						### Install some stuff

						Sometimes you run old software :'(

						Does running
						```bash
						git --version
						```

						Show you something &lt; 1.9???

						Lets fix that!

						```bash
						sudo apt-add-repository ppa:git-core/ppa
						sudo apt-get update
						sudo apt-get install git
						```
					</section>

					<section data-markdown>
						### Install some stuff

						A gui might be nice

						```bash
						sudo apt-get install gitg
						            OR
						sudo apt-get install gitk

						```

					</section>
-->
					<section data-markdown>
						### Basic config for these machines

						Git would like you to specify

						1. Your full name
						1. Your email address
						1. Your favourite text editor

						```bash
						git config --global user.name "Dr. Henry Killinger"
						git config --global user.email "fu@bar.baz"
						git config --global core.editor vim
						```

						All these settings are stored in **~/.gitconfig**
					</section>
					<section data-markdown>
						<script type="text/template">
							### Sane defaults for day to day use

							* Use colour to highlight branches and diffs
							* Make sure you only push the branch you're on
							* Show branches and tags in git log
							* Setup rebase as the default strategy for git pull

							```bash
							git config --global color.ui always
							git config --global push.default current
							git config --global log.decorate full
							git config --global pull.rebase true
							```

							All these settings are stored in **~/.gitconfig**
						</script>
					</section>
					<section>
						<h3>Quick review of basic git</h3>
						<p>
							<a href="pages/git-cheatsheet.html" target="_blank">
								http://ndpsoftware.com/git-cheatsheet.html
							</a>
						</p>
						<div><img src="images/git-basic.png" style="border:0; max-height: 450px;"></div>
					</section>
<!--
					<section data-markdown>
						<script type="text/template">
							### Unlocking achievements, making git a bit more fun

							Unlock Achievements!

							Track friends over RSS!

							Flaunt your achievements with a Splashy page!
						</script>
					</section>

					<section data-background-image="images/github-chalk.jpg"></section>
					<section data-markdown>
						![fork me](images/github-git-acheivements.png)
					</section>

					<section>
						<div data-markdown>
							### Unlocking Achievements in Git
							----------------------------------------
							If you have a github account

							1. https://github.com/icefox/git-achievements
							2. Fork that repo
							3. Go to your forked project, and clone it
							----------------------------------------

							No account? You can still run it locally, just don't let it push
							```bash
							git clone https://github.com/icefox/git-achievements.git
							```
						</div>
					</section>

					<section data-markdown>
						<script type="text/template">
							### Setup
							Alias git-achievements in your shellrc file

							```bash
							vim ~/.bashrc

							# Put these lines at the bottom of your file
							export PATH="$PATH:~/git/git-achievements"
							alias git="git-achievements"

							# Run this ONLY IF YOU FORKED
							git config --global achievement.upload "true"
							```

							Keep your achievements after the course, save this file
							```bash
							~/.git-achievements-action.log
							```
						</script>
					</section>

					<section>
						<h3>Fun achievements to unlock!</h3>
					</section>

					<section>
						<hr>
						<p>Banker (Level 5)</p>
						<p>Join two or more development histories together with git-merge.</p>
						<hr>
					</section>

					<section>
						<hr>
						<p>Garage Inventor (Level 1)</p>
						<p>Used a custom alias for a Git command</p>
						<hr>
					</section>

					<section>
						<hr>
						<p>Apprentice Thug (Level 3)</p>
						<p>Forced pushed a branch with git-push -f</p>
						<hr>
					</section>

					<section>
						<hr>
						<p>Let there be light</p>
						<p>Commit without a parent.</p>
						<hr>
					</section>
-->
					<section data-markdown>
						### Part 1: Getting started
						### [COMPLETE]
						* Objectives
							<!--
							- Install some stuff &#10004;
							-->
							- Basic config for these machines &#10004;
							- Good config defaults &#10004;
							- Quick review of basic git &#10004;
							<!--
							- Unlocking achievements, making git a bit more fun &#10004;
							-->
					</section>

					<section data-background-image="images/dazzle.gif"></section>
				</section>

				<!-- Personal workflows -->
				<section>
					<section data-markdown>
						* Part 1: Getting Started &#10004;
						### Part 2: Personal workflows
						* Part 3: Team workflows
						* Part 4: Releases and Client workflows
						--------------------------------------------------------------------------------
						### Objectives
						- Context hunting / Isolate and Triage issues
						- Mastering branches
						- Audit work interactively
						- Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- __Isolate and Triage: Context hunting &lt;-- you are here__
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section>
						<img src="images/individual-workflow.svg" height="500px">
						<aside class="notes">
							<ul>
								<li>Isolate: Figure out where the problem is.</li>
								<li>Triage: Figuring out urgency/priority of task (Is it dev work or a hotfix?).</li>
							</ul>
						</aside>
					</section>

					<section data-markdown data-separator-notes="^Note:">
						### Context hunting / Isolate, Triage
						This is a BEFORE YOU START thing, helps isolate and triage

						----------------------------------------
						Context is important so you can...

						* Avoid regressing your codebase
						* Find out if code is still under warranty
						* Get help if you get stuck, seek out a human
						----------------------------------------

						Note:
						Before you start editing code, use Git to understand context:

						- Who wrote this?
						- What were they doing?
						- What will my change effect?
						- When did this issue start to occur?
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting
								* __Log - Show commit logs &lt;-- you are here!__
								* Bisect - binary search for bugs
								* Blame - revision and author for lines of a file
								* Pickaxe - Search commit diffs for changes
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						Regular log
						```bash
						git log
						```
						![regular git log](images/git-log.png)
					</section>

					<section data-markdown>
						Show me contents of patches
						```bash
						git log -p
						```
						![patch mode git log](images/git-log-p.png)
					</section>

					<section data-markdown>
						Show me a summary of patches
						```bash
						git log --stat
						```
						![stats](images/git-log-stat.png)
					</section>

					<section data-markdown>
						Find changes associated with text in a commit message:
						```bash
						git log --grep '$search_term'
						git log --grep 'bug#1234'
						```
						![grep for messages](images/git-log-grep-term.png)
					</section>

					<section data-markdown>
						View the tree of commits:
						```bash
						git log --graph
						```
						![git log tree](images/git-log-graph.png)
					</section>

					<section data-markdown>
						You can get pretty fancy with git log:
						```bash
						git config --global alias.treelog "log --graph --abbrev-commit --decorate --date=relative --format=format:'%C(bold blue)%h%C(reset) - %C(bold green)(%ar)%C(reset) %C(white)%s%C(reset) %C(dim white)- %an%C(reset)%C(bold yellow)%d%C(reset)' --all"
						git treelog
						```

						![git log tree](images/git-pretty-log.png)

						(Or just use gitk or tig)
					</section>

					<section data-markdown>
						Filter the log:

						```bash
						# Show commits affecting index.html
						git log index.html
						# Show commits affecting index.html (Including those made when it wasn't named index.html)
						git log --follow index.html
						# Show commits from a specific user
						git log --author ben-denham
						# Show commits in a certain date range
						git log --before 03-15-2014 --after 03-08-2014
						# Show commits in the experiment branch that aren't in master
						git log master..experiment
						# Show commits in experiment and master that are not in both.
						git log master...experiment
						```
					</section>

					<!-- Git bisect -->
					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting
								* Log - Show commit logs &#10004;
								* __Bisect - binary search for bugs &lt;-- you are here!__
								* Blame - revision and author for lines of a file
								* Pickaxe - Search commit diffs for changes
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						### Bisect: Binary search for bugs

						You can search 100 commits in 10 steps to find a bad commit!

						----------------------------------------
						To bisect, you need...

						1. A ref (tag/hash/branch) to a known bad commit
						2. A ref to a known good commit

						```bash
						git bisect start $bad_commit $good_commit

						# ... test your code ...
						git bisect bad
						git bisect good

						# put things back with
						git bisect reset
						```
					</section>

					<section data-markdown>
						### Bisect: When it's not testable
						If your history has broken commits, maybe it's impossible to test

						```bash
						# test around an problematic commit
						git bisect skip

						# or save where you're up to, and come back later
						git bisect log &gt; bisect.log
						# ... time passes
						git bisect reset
						git bisect replay bisect.log
						```
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting
								* Log - Show commit logs &#10004;
								* Bisect - binary search for bugs &#10004;
								* __Blame - revision and author for lines of a file &lt;-- you are here!__
								* Pickaxe - Search commit diffs for changes
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						### Blame: Basic usage
						```bash
						git blame $filename

						# to get the context around the change of a line
						git show $hash
						```
						![git blame](images/git-blame.png)
					</section>

					<section data-markdown>
						### Blame: Power tools
						* Ignore whitespace changes (might be hiding a commit)
						* Copy paste detection in a file, and across the repo
						* Track refactorings of methods across a codebase
						----------------------------------------

						```bash
						git blame -w $filename # ignore whitespace
						git blame -M $filename # copy paste within the same file
						git blame -C $filename # copy paste over the repo
						```
					</section>

					<!-- Git blame -->
					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting
								* Log - Show commit logs &#10004;
								* Bisect - binary search for bugs &#10004;
								* Blame - revision and author for lines of a file &#10004;
								* __Pickaxe - Search commit diffs for changes &lt;-- you are here!__
							- Work: Mastering branches
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						### Pickaxe
						What happened to __myFabuliousFunc()__, it's gone!

						When did __$mySillyVariable__ get referenced everywhere?

						----------------------------------------

						Search commit diffs for changes

						* Find all the changes to a line in your entire history
						* The pickaxe can help find code that’s been deleted or moved
						* Works with log, diff, format-patch and tig

						```bash
						git log -S 'some distinct line that changed'
						git log --stat -S '$racebook_uri_result'
						```
					</section>

					<section data-markdown>
						### Activity: Testing bisect
						1. Clone the jabberwocky repo, pull tags
						3. Use bisect with __v1__ and __v2__ tags as good/bad commits
						4. find the commit that broke the page

						```bash
						# Fetch repository and tags
						git clone https://github.com/catalyst-training/jabberwocky
						cd jabberwocky
						git fetch --tags
						# Test code
						firefox jabberwocky.html
						git log --stat

						# Start bisect
						git bisect start $bad $good

						# Now test the code!
						# When a commit exhibits wanted behaviour
						git bisect good

						# When a commit exhibits unwanted behaviour
						git bisect bad
						```
					</section>

					<section data-markdown>
						Don't forget to tidy up with...
						```bash
						git bisect reset
						```
					</section>

					<section>
						<div data-markdown>
							### Activity: Testing log, pickaxe, blame and show
							1. Clone jquery repo
							2. Use git log to find fixes to issue #14756
							3. Use pickaxe to find commits that added or removed 'parseFloat'
							4. Try git blame on the .gitignore file
							5. With this info, show the commit that blacklisted node_modules

							```bash
							git clone https://github.com/jquery/jquery
							cd jquery
							git log --grep 'asdf'
							git log -p -S 'asdf'
							git blame $file
							git show $hash
							```

							Note:

							- Test this the day before the course
							- git log about issue (use a recent issue number)
							- Pickaxe to find commits.
							- Git blame and then git show to look at a commit.
						</div>
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting &#10004;
							- __Work: Mastering branches &lt;-- you are here!__
							- Update, Test: Audit work interactively
							- Share: Manage merge conflicts like a pro
					</section>

					<section data-markdown>
						### Mastering branches: Overview
						![Feature branches](
							images/branches-multi.png
						)
						![Merge branches](
							images/branches-typical.png
						)

						Branching should reflect your team's workflow.
					</section>

					<section data-markdown>
						![](
							images/branches-perspective.png
						)

						Isolate work till you're ready to release
					</section>

					<section data-markdown>
						### Git commits

						Git thinks in Snapshots, Not Differences

						> The major difference between Git and any other VCS (Subversion and friends included)
						> is the way Git thinks about its data.

						_quote from git-scm.com, ch 1.3 "Getting Started: Git Basics"_
					</section>

					<section data-markdown>
						### Commits: Git vs SVN
						![Subversion commits](
							images/branches-svn.png
						)

						----------------------------------------
						![Git commits](
							images/branches-commits.png
						)

						Note:
						It's really easy to see what the project looked like at a particular commit.
					</section>

					<section data-markdown>
						### Commits in context
						* A single commit: you refer to an entire filesystem layout
						* Multiple commits: you usually think in diffs
						* Commits are immutable, but you can re-create a new history

						----------------------------------------
						You can refer to commits with a...

						* **branch**			- a name to track your work
						* **tag**					- a label, it doesn't move
						* **commit hash**	- complete history and set of files
						* **HEAD**				- your current checkout
						* **$ref^**   		- above are $refs, chain ^ or ~ to go up a branch

						----------------------------------------

						Lets look at how we can use these with commands
					</section>

					<section data-markdown>
						### Mastering branches: Commands
						Interesting commands with branches
						```bash
						git checkout $branch
						git merge $branch
						git rebase $branch
						git rebase --interactive $branch
						git reset $ref
						```
						----------------------------------------
						* **Checkout**: context dependent command...
							1. Either reset unstaged file(s)
							2. Or switch branches
						* **Merge**: Create a new commit with multiple parent commits
						* **Rebase**: Batch move commits and rewrite history
						* **Reset**: Move branches around arbitarily
						* **Reflog**: Save my ass! What have I had 'checked out' recently?
						----------------------------------------
						Whiteboard time!
					</section>

					<section>
                                            <p>What will reset/checkout affect?</p>
					    <table>
                                                <thead><tr>
                                                    <th width="42%"></th>
                                                    <th>HEAD</th>
                                                    <th>Index</th>
                                                    <th>Workdir</th>
                                                    <th>WD Safe?</th>
                                                </tr></thead>
                                                <tbody>
                                                    <tr>
                                                        <td><p><strong>Commit Level</strong></p></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>reset --soft [commit]</code></p></td>
                                                        <td><p>REF</p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>YES</p></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>reset [commit]</code></p></td>
                                                        <td><p>REF</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>YES</p></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>reset --hard [commit]</code></p></td>
                                                        <td><p>REF</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p><strong>NO</strong></p></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>checkout [commit]</code></p></td>
                                                        <td><p>HEAD</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>YES</p></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><strong>File Level</strong></p></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>reset (commit) [file]</code></p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>YES</p></td>
                                                    </tr>
                                                    <tr>
                                                        <td><p><code>checkout (commit) [file]</code></p></td>
                                                        <td><p>NO</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p>YES</p></td>
                                                        <td><p><strong>NO</strong></p></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <p>Git Book - Chapter 7.7</p>
					</section>

					<section data-markdown data-background-image="images/oops.gif">
						```bash
						# ...fiddle fiddle fiddle, fixing one thing
						# OOP... NOOOOOOO!!!! Undo undo undo!
						git reflog
						```
					</section>

					<section data-markdown>
						### Mastering branches: Headless state
						If you're not on a branch, git puts you in a headless state
						```bash
						git checkout $tag
						git checkout $commit
						```

						Trying something like this...
						```bash
						git checkout HEAD^
						```
					</section>

					<section data-markdown>
						But don't worry, git is being melodramatic when it says...

						```bash
						You are in 'detached HEAD' state. You can look around, make experimental
						changes and commit them, and you can discard any commits you make in this
						state without impacting any branches by performing another checkout.

						If you want to create a new branch to retain commits you create, you may
						do so (now or later) by using -b with the checkout command again. Example:

						git checkout -b new_branch_name

						HEAD is now at f4b37d8... CSS: Return values should be numbers
						```
					</section>

					<section data-markdown>
						### Activity: Mastering Branches
						1. Navigate to your Jabberwocky repo clone
						2. Checkout 'master'
						3. Fix the bug, commit
						4. Interactive rebase onto the tag v1
						5. Squash your fix with 'Oops' and give it a message.

						```bash
						cd $jabberwocky_dir
						vim jabberwocky.html
						git add jabberwocky.html
						git commit
						git log
						git rebase $ref --interactive
						git log -p
						```

						...it's as if the error was never there. Now put it back

						```bash
						git reset origin/master --hard
						```
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting &#10004;
							- Work: Mastering branches &#10004;
							- __Update, Test: Audit work interactively &lt;-- you are here!__
							- Share: Manage merge conflicts like a pro
					</section>

					<section>
						<div data-markdown>
							### Audit work interactively
							Audit your work interactively with your staging area

							1. When you're ready to commit locally
							2. When you want to break up a monster commit

							----------------------------------------
							### Quick activity

							```bash
							# Add new first and last verses to the jabberwocky poem, then run
							git add -p
							# Check what's happened with
							git status
							# Put stuff back with
							git reset HEAD
							```

							(``-p`` also works with reset and checkout)
						</div>
					</section>

					<section data-markdown>
						### Part 2: Personal workflow
						* Objectives
							- Isolate and Triage: Context hunting &#10004;
							- Work: Mastering branches &#10004;
							- Update, Test: Audit work interactively &#10004;
							- __Share: Manage merge conflicts like a pro &lt;-- you are here!__
					</section>

					<section>
						<div data-markdown>
							### Manage merge conflicts like a pro
							Source control is about social coding and interactions.

							A conflict should be a conversation. When you see
							```bash
							CONFLICT (content): Merge conflict in jabberwocky.html
							Automatic merge failed; fix conflicts and then commit the result.
							```
							Get info with
							```bash
							git status
							git blame $file
							```
							Markers are usually HEAD and a $ref, where:

							1. HEAD is work of yours
							2. $ref is the thing you're in conflict with

							```bash
							git merge $ref
							```
						</div>
					</section>

					<section>
						<img src="images/individual-workflow.svg" height="500px">
					</section>

					<section data-markdown>
						### Part 2: Personal workflow [COMPLETE]
						* Objectives
							- Isolate and Triage: Context hunting &#10004;
							- Work: Mastering branches &#10004;
							- Update, Test: Audit work interactively &#10004;
							- Share: Manage merge conflicts like a pro &#10004;
					</section>

					<section data-background-image="images/3-steps.gif"></section>
				</section>

				<section>
					<section data-markdown>
						* Part 1: Getting Started &#10004;
						* Part 2: Personal workflows &#10004;
						### Part 3: Team workflows
						* Part 4: Releases and Client workflows
						--------------------------------------------------------------------------------
						### Objectives
						- Quickly setup local, network accessible repos
						- Working with people who don't enjoy source control
						- Clean history, rebase verses merge
					</section>

					<section>
						<img src="images/share.gif" height="350px">
						<p>When you use git to share your stuff</p>
					</section>
					<section>
					    <div data-markdown>
						### Corporate Workflow
						You will probably use this
					    </div>
					    <img src="images/workflow-a.png" alt="corporate">
					</section>
					<section>
					    <div data-markdown>
						### Integration manager Workflow
						A quick diversion: http://www.github.com
					    </div>
					    <img src="images/workflow-b.png" alt="github">
					</section>
					<section>
					    <div data-markdown>
						### Dictator Workflow
						This is how the Linux kernel is managed
					    </div>
					    <img src="images/workflow-c.png" alt="linux">
					</section>
					<section>
					    <div data-markdown>
						### Peer to peer Workflow
					    </div>
					    <img src="images/workflow-d.png" alt="p2p">
					</section>
					<section>
						<div data-markdown>
							### Quickly setup local, network accessible repos
							Git just tracks content. All history is stored in .git directory, and sharing
							is just mushing content around in there.

							To modify remotes...
							```bash
							git remote add $alias $location
							git remote rm $alias $location
							```
							Location can be...

							1. ssh://[user@]host.xz[:port]/path/to/repo.git/
							1. git://host.xz[:port]/path/to/repo.git/
							1. http[s]://host.xz[:port]/path/to/repo.git/
							1. ftp[s]://host.xz[:port]/path/to/repo.git/
							1. rsync://host.xz/path/to/repo.git/
						</div>
					</section>

					<section data-markdown>
							### Quickly setup local, network accessible repos
							Enter custom alias! You just need to run this once...

							```bash
							# Set up a global "git serve" alias.
							git config --global alias.serve "daemon --verbose --export-all
									--base-path=.git --reuseaddr --strict-paths .git/"
							# Allow your repository to be shared.
							touch .git/git-daemon-export-ok
							```

							Now you too can share your terrible poetry with your neighbour!

							Navigate to your repository, and run
							```bash
							git serve
							```

							And you'll be __Ready to rumble__
						</section>

						<section data-markdown>
							### Pull work from your neighbour
							```bash
							# Make some changes and commit.
							echo 'My name' >> jabberwocky.html
							git commit -am "Added my name".

							# Find your IP address (or hostname)
							ip ad

							# Serve your jabberwocky poem to the network
							cd ~/jabberwocky
							git serve

							# Get your neighbours network details
							# Lets add their work to your repo
							git remote add neighbour git://$host/
							git fetch

							# What's different between our branches?
							git diff neighbour/master master

							# Merge their work in (merge conflict ahead)
							git merge neighbour/master
							```
					</section>

					<section>
						<div data-markdown>
							### Working with people who don't enjoy source control
							Idea #1: Empower them, let them manage their commits, but manage their merges

							![](images/branches-typical.png)
						</div>
					</section>
					<section>
						<div data-markdown>
							### Working with people who don't enjoy source control
							Idea #2: Manage their commits and merges

							```bash
							while true; do
								clear;
								git add .
								git commit -m "$designer updated UX."
								sleep 5;
							done;
							```
						</div>
					</section>
					<section>
						<img src="images/under-attack.gif" height="500px">
						<p>Wrestling with git</p>
						<aside class="notes">
							Don't force Git in people's faces.
						</aside>
					</section>
					<section>
						<div data-markdown>
							### Clean history, rebase verses merge
							* When to merge: If you've pushed it, you can't change things without pain.
							* If you have multiple conflicts, try for a merge
							* Don't rebase long chains of commits
								* you'll have to repeat merge conflict resolution, unless you use rerere
							* Avoid squashing lots of commits, so that you keep the history.

							----------------------------------------
							Discuss:
							```bash
							git pull --rebase
							```
							```bash
							git config --global pull.rebase true
							git pull
							```
							```bash
							git rebase --abort
							git merge --abort
							```

							Note:

							- rerere = reuse recorded resolution
							- git config rerere.enabled true
						</div>
					</section>

					<section data-markdown>
						### Part 3: Team workflows [COMPLETE]
						- Objectives
							- Quickly setup local, network accessible repos &#10004;
							- Working with people who don't enjoy source control &#10004;
							- Clean history, rebase verses merge &#10004;
					</section>

					<section data-background-image="images/git-to-svn-users.gif"></section>
				</section>

				<section>
					<section data-markdown>
						* Part 1: Getting Started &#10004;
						* Part 2: Personal workflows &#10004;
						* Part 3: Team workflows &#10004;
						### Part 4: Release Management
						--------------------------------------------------------------------------------
						### Objectives
						- Strategies for dealing with release requirements
						- Strategies for database patching on branches
					</section>

					<section>
						<div data-markdown>
							### Strategies for dealing with client requirements
							The battle of flexibility vs simplicity

							----------------------------------------

							A typical client may ask you to be flexible on the following

							* Track changes, find bugs and release when you can
							* Working on features and releases in parallel
							* Have feature freezes before releases
							* Track which version is running in each environment.
							* Construct release candidates based on feature sets
							* Release partial applications (modular)
						</div>
					</section>
					<section data-background-image="images/personal-workflows.gif">
						<h3 style="color:white">Release all the things!</h3>
					</section>

					<section class="workflow-images">
						<div data-markdown>
							### Client requirements: Linear history

							![](images/workflow-1.png)

							* Simple, single-branch
							* Track changes, find bugs and release when you can
							* Tag releases
							* Doesn't scale well for many devs (frequent merging)
							* You only work on one feature/release at a time
						</div>
					</section>
					<section class="workflow-images">
						<div data-markdown>
							### Client requirements: Parallel features

							![](images/workflow-2.png)

							* Each feature/issue is worked on in a separate branch.
							* Many devs can work independently, then merge later.
							* A single developer can work on multiple issues at once.
						</div>
					</section>
					<section class="workflow-images">
						<div data-markdown>
							### Client requirements: Merge forward releases

							![](images/workflow-3.png)

							* Fairly simple; each release has its own branch
								* Merge older release branches into newer branches when they change
								* Assumes each release depends on the previous one
							* Work on multiple releases at the same time
							* Release fixes for v1 while working towards v2
						</div>
					</section>
					<section class="workflow-images">
						<div data-markdown>
							### Client requirements: Feature freezes and env-tracking

							![](images/workflow-4.png)

							* Release branches can be used to enable a feature freeze.
							* Feature work continues on master, while only bug-fixes are made on v2.
							* Bug-fixes are merged back into master from v2.
							* You may also like to have a branch to track each environment.
						</div>
					</section>
					<section class="workflow-images">
						<div data-markdown>
							### Gitflow

							![](images/gitflow.png)

							* Explanation: http://nvie.com/posts/a-successful-git-branching-model/
							* Command-line tool: https://github.com/nvie/gitflow
						</div>
					</section>
					<section>
						<div data-markdown>
							### Client requirements: Feature releases
							* Every piece of work is a feature (with its own 'feature branch')
							* Features are octo-merged into a release candidate
							* Features can be excluded from a particular release
<!--
							* Need to track production somehow (tag or a branch)
							* Difficult to rollback a release (especially database patches).
								- Instead, create new feature branches to resolve issues.
-->

							![](images/feature-releases-1.png)

							Note:

							- Image: Creation of a release candidate.
							- If an octomerge has conflicts:
								- Find the 2+ problematic branches (can be tricky)
								- Merge them together into a NEW feature branch, which can then be used in the octomerge
								- Reason: have no conflict resolution in the release candidate, so that the merge is reproducible.
							- QA the release candidate, and make fixes on the feature branches.
								- Release candidate gets promoted to prod (stable).
								- Stable gets merged back into the feature branches.

						</div>
					</section>
<!--
					<section>
						<div data-markdown>
							### Feature releases... omg
							![](images/feature-releases-2.png)

							Note:
							- Creating a feature branch (wr210708) and working on it.
							- Note the merging of stable back into the feature branch.
						</div>
					</section>
					<section>
						<div data-markdown>
							### Feature releases... more woah
							![](images/feature-releases-3.png)

							Note:

							- View of history with multiple releases (nightwatch and nimblefoot)
							- nimblefoot gets merged together with a whole bunch of other feature branches to create nightwatch.
						</div>
					</section>
-->
					<section class="align-top-images">
						<div data-markdown>
							### Client requirements: Microkernel architecture
							* Difficulty is abstracted to the application.
							* Modelled off the Linux kernel: many modules connect to a small core via APIs.
							* Usually separate repos for each module (sometimes combined using git submodules).
							* Modules of application can be worked on at the same time with different workflows.
							* A release would package together modules at different versions.
<!--
							![](images/basic-branching-2.png)
							![](images/release-branches.png)
-->
						</div>
					</section>
					<section data-background-image="images/choose.gif">
						<h1 style="color:white">Each has its costs! Choose the one that works best</h1>
					</section>
					<section>
						<div data-markdown>
							### Database migrations
							Git doesn't care about non-filesystem entities

							Database migrations (patches) are important to get right

							----------------------------------------

							- Have a numbering/naming convention for migrations.
							- Create migrations with UP and DOWN instructions.
								* Makes it easier to upgrade/downgrade the database working when switching between commits.
							- Use git bisect with a script to drop the database, re-apply your migrations, and run a test (or prompt you for input):

							```bash
							git bisect run my_script.py
							```
						</div>
					</section>
				</section>

				<section>
					<h2>Further Reading</h2>
					<ul>
						<li>
							<a href="http://git-scm.com">git-scm.com</a>
							- An ebook with plenty of gitty goodness
						</li>
						<li>
							Schwern's talk:
							<a href="http://www.youtube.com/watch?v=1ffBJ4sVUb4">Git for ages 4 and up</a>
						</li>
						<li>
							man gitworkflows
						</li>
					</ul>
          <hr>
					<h2>Attribution</h2>
					<ul>
						<li><a href="http://git-scm.com">git-scm.com</a> for some images</li>
						<li><a href="http://devopsreactions.tumblr.com/post/50800607139">devops reactions</a> for awesome animated gifs</li>
						<li><a href="https://github.com/hakimel/reveal.js">reveal.js</a> for unbad slides</li>
					</ul>
				</section>

				<section data-markdown>
					## Course Information
					Slides can be found on

					[github.com/ben-denham/git-advanced](
						https://github.com/ben-denham/git-advanced
					)

					Feedback? Corrections? Questions?

					Please leave an issue against the course github page.
				</section>

				<section>
					<img class="cat-slogan-image" src="css/theme/images/freedom-to-innovate.svg" alt="freedom to innovate">
					<img src="images/big-end.gif" alt="Boom" style="height:500px;">
				</section>
			</div>

			<div class="footer">
				<div class="scarf">
					<div class="scarf-orange"></div>
					<div class="scarf-yellow"></div>
					<div class="scarf-blue"></div>
					<div class="scarf-green"></div>
				</div>
				<div class="footer-inner">
					<div>
						<!-- NOTE: use only one of these. open-source-technologists is the standard -->
						<p class="open-source-technologists">open source technologists</p>
						<!-- <p class="freedom-to-innovate">freedom to innovate</p> -->
					</div>
				</div>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				//transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
				transition: 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					//{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/markdown/highlight_upstream.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
